library(plotly)
data <- read.csv(file="MM5-3vsMM.csv", header=TRUE, sep=",")
wrongline = data[,1] != "Starter"
data = data[wrongline,]

data$P1depth <-  as.numeric(as.character(data$P1depth))
data$P1weight <-  as.numeric(as.character(data$P1weight))
data$P2depth <-  as.numeric(as.character(data$P2depth))
data$P2weight <-  as.numeric(as.character(data$P2weight))
data$TotalChips <- as.numeric(as.character(data$TotalChips))

data <- data[with(data, order(P2depth,P2weight)),]


data$TotalChips <-  NULL
data$P2weight <-  NULL
data$P2depth <-  NULL
data$P2color <-  NULL


W <- 1:10
D <- 1:6

nb.game.in.vs = 3 * 2 + 2*7 +2*49
mset = length(D) * length(W) * nb.game.in.vs



if(mset != length(data[,1]))
{
  print("ERROR DATA")
}


for(i in c(0,length(W)*length(D)-1)){

  data.select <- data[(i * nb.game.in.vs + 1):( (i+1) * nb.game.in.vs),]
  winer <-  data.frame(table(data.select$Winner))
 }




##                                         # delete data
## d1=data.frame(data$P2weight,data$P2depth,data$Winner)
## d2=data.frame(data$P2depth,data$Winner)

f <- data.frame(table(data$Winner,data$P1depth))
red.win = f[f$Var1=="Red",3]
green.win =f[f$Var1=="Green",3]
noOne= f[f$Var1=="No one",3]
#Ylim =c(min(red.win,green.win)-10,max(red.win,green.win)+10)
Ylim =c(0,max(red.win,green.win)+10)
Xlim =range(D)
plot("Depth","Number of wins",xlim = Xlim,ylim=Ylim)

lines(x=D,y=red.win,col="red")
lines(x=D,y=green.win,col="green")
lines(x=D,y=noOne)

Percentage_Of_Wins = green.win/(red.win + green.win + noOne)
Percentage_Of_Loss = red.win/(red.win + green.win + noOne)
plot(x=D,y=Percentage_Of_Wins*100,type = "l")

f <- data.frame(table(data$Winner,data$P1weight))

red.win = f[f$Var1=="Red",3]
green.win =f[f$Var1=="Green",3]
noOne= f[f$Var1=="No one",3]
#Ylim =c(min(red.win,green.win)-10,max(red.win,green.win)+10)
Ylim =c(0,max(red.win,green.win)+10)
Xlim =range(W)
plot("Weight","Number of wins",xlim = Xlim,ylim=Ylim)

lines(x=W,y=red.win,col="red")
lines(x=W,y=green.win,col="green")
lines(x=W,y=noOne)

Percentage_Of_Wins = green.win/(red.win + green.win)
plot(x=W,y=Percentage_Of_Wins*100,type = "l")


#f <- data.frame(table(data$Winner,data$P1depth,data$P1weight))
#red.win = f[f$Var1=="Red",]
#green.win = f[f$Var1=="Green",]
#noOne = f[f$Var1=="No one",]
#m=matrix(red.win$Freq,4,3)
#plot3D::persp3D(x=D,y=W,z=m)


#zlim <- range(m)

#zlen <- zlim[2] - zlim[1] + 1

#colorlut <- terrain.colors(zlen) # height color lookup table
#col <- colorlut[ z - zlim[1] + 1 ]

##3D


red.data= data[data$Winner=="Red",]
fr <- data.frame(table(red.data$P1weight,red.data$P1depth))

green.data= data[data$Winner=="Green",]
fg <- data.frame(table(green.data$P1weight,green.data$P1depth))

noone.data= data[data$Winner=="No one",]
fo <- data.frame(table(noone.data$P1weight,noone.data$P1depth))

mr = matrix(fr$Freq,length(W),length(D))
mg = matrix(fg$Freq,length(W),length(D))
mo = matrix(fo$Freq,length(W),length(D))


axx <- list(
  title = "Depth"
)

axy <- list(
  title = "Weight"
)

axz <- list(
  title = "Wins"
)
axz2 <- list(
  title = "Loss percentage"
)

plot_ly(x=D,y=W,z=mg,type="surface")%>%
  layout(scene = list(xaxis=axx,yaxis=axy,zaxis=axz))
plot_ly(x=D,y=W,z=mr,type="surface")
plot_ly(x=D,y=W,z=mo,type="surface")

mp = mr / (mg + mr + mo)
plot_ly(x=D,y=W,z=mp,type="surface")%>%
  layout(scene = list(xaxis=axx,yaxis=axy,zaxis=axz2))
